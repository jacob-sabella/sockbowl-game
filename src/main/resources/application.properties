# Spring
spring.mvc.converters.preferred-json-mapper=gson
server.port=${SOCKBOWL_PORT}

logging.level.org.apache.kafka=OFF

# Redis
sockbowl.redis.game-cache.hostname=${SOCKBOWL_REDIS_HOST}
sockbowl.redis.game-cache.port=${SOCKBOWL_REDIS_PORT}
sockbowl.redis.game-cache.database=${SOCKBOWL_DATABASE}

# Kafka
sockbowl.kafka.topic.game-topic=${SOCKBOWL_KAFKA_GAME_TOPIC}
sockbowl.kafka.bootstrap-servers=${SOCKBOWL_KAFKA_BOOTSTRAP_SERVERS}

# Sockbowl questions
sockbowl.questions.url=${SOCKBOWL_QUESTIONS_URL}

# Sockbowl CORS config
sockbowl.websocket.allowed-origins=${SOCKBOWL_GAME_ALLOWED_ORIGINS:localhost:4200}

# Authentication - Feature flag to enable/disable authentication
sockbowl.auth.enabled=${SOCKBOWL_AUTH_ENABLED:true}

# User Database (separate from Keycloak) - only used if auth is enabled
spring.datasource.url=${SOCKBOWL_DB_URL:jdbc:postgresql://localhost:5432/sockbowl_users}
spring.datasource.username=${SOCKBOWL_DB_USERNAME:postgres}
spring.datasource.password=${SOCKBOWL_DB_PASSWORD:123456789}
spring.jpa.hibernate.ddl-auto=update
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.show-sql=false

# Keycloak OAuth2/OIDC Configuration - only used if auth is enabled
spring.security.oauth2.client.registration.keycloak.client-id=${KEYCLOAK_CLIENT_ID:sockbowl-game}
spring.security.oauth2.client.registration.keycloak.client-secret=${KEYCLOAK_CLIENT_SECRET:}
spring.security.oauth2.client.registration.keycloak.scope=openid,profile,email
spring.security.oauth2.client.registration.keycloak.authorization-grant-type=authorization_code
spring.security.oauth2.client.registration.keycloak.redirect-uri={baseUrl}/api/v1/auth/callback

spring.security.oauth2.client.provider.keycloak.issuer-uri=${KEYCLOAK_ISSUER_URI:http://localhost:8080/realms/sockbowl}
spring.security.oauth2.client.provider.keycloak.user-name-attribute=preferred_username

# JWT Resource Server (validate Keycloak tokens) - only used if auth is enabled
spring.security.oauth2.resourceserver.jwt.issuer-uri=${KEYCLOAK_ISSUER_URI:http://localhost:8080/realms/sockbowl}
